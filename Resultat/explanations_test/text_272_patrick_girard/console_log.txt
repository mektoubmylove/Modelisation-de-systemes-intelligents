texte analysé: de remporter des victoires sur mer , je ne donnerais pas cher de l avenir de carthage . nous devons agir immédiatement . hannibal le prudent , tu partiras avec une partie de la flotte pour panormos . ...
prédiction: HOMME (confiance: 55.8%)
vérité terrain: HOMME
Visualisation des contrib par mot 
# analyse pour la classe: FEMME
# logit: -0.0974
chain rule : ∂sortie/∂terme = Σ ∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme
ordre de la rétropropagation : sortie → L2 → L1 → terme
 couche de sortie → termes via tout le réseau
calcul : ∂sortie/∂terme = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

 termes poussant vers 'FEMME' (contribution finale):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       +0.000297       0.3624
   2      précepteur                     +0.000196       0.2962
   3      cingla                         +0.000187       0.1575
   4      messager                       +0.000079       0.1048
   5      éduqué                         +0.000076       0.1519
   6      flotte                         +0.000074       0.2247
   7      constituait                    +0.000071       0.0913
   8      partiras                       +0.000061       0.1591
   9      attentions                     +0.000061       0.0981
   10     effectivement                  +0.000053       0.0765
   11     hôtes                          +0.000047       0.0816
   12     repéré                         +0.000046       0.0830
   13     influents                      +0.000046       0.1575
   14     remporter                      +0.000040       0.1229
   15     durant                         +0.000039       0.0535

 termes éloignant de 'FEMME' (contribution finale):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      accompagnera                   -0.000102       0.1419
   2      supplique                      -0.000099       0.1399
   3      conque                         -0.000089       0.1599
   4      manquaient                     -0.000085       0.0799
   5      idéal                          -0.000082       0.0651
   6      retrouverai                    -0.000079       0.1134
   7      veuf                           -0.000070       0.1026
   8      esclave                        -0.000066       0.1708
   9      romaine                        -0.000065       0.1123
   10     respecte                       -0.000059       0.0799
   11     multiples                      -0.000051       0.0755
   12     nobles                         -0.000050       0.0868
   13     grandi                         -0.000047       0.0701
   14     vienne                         -0.000044       0.0539
   15     regrette                       -0.000042       0.0601
couche 2 (32 neurones) → influence via L1 → L2
calcul : ∂sortie/∂terme via L2 = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

 termes poussant vers 'FEMME' (via L1 → L2):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       +0.000297       0.3624
   2      précepteur                     +0.000196       0.2962
   3      cingla                         +0.000187       0.1575
   4      messager                       +0.000079       0.1048
   5      éduqué                         +0.000076       0.1519
   6      flotte                         +0.000074       0.2247
   7      constituait                    +0.000071       0.0913
   8      partiras                       +0.000061       0.1591
   9      attentions                     +0.000061       0.0981
   10     effectivement                  +0.000053       0.0765
   11     hôtes                          +0.000047       0.0816
   12     repéré                         +0.000046       0.0830
   13     influents                      +0.000046       0.1575
   14     remporter                      +0.000040       0.1229
   15     durant                         +0.000039       0.0535

 termes éloignant de 'FEMME' (via L1 → L2):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      accompagnera                   -0.000102       0.1419
   2      supplique                      -0.000099       0.1399
   3      conque                         -0.000089       0.1599
   4      manquaient                     -0.000085       0.0799
   5      idéal                          -0.000082       0.0651
   6      retrouverai                    -0.000079       0.1134
   7      veuf                           -0.000070       0.1026
   8      esclave                        -0.000066       0.1708
   9      romaine                        -0.000065       0.1123
   10     respecte                       -0.000059       0.0799
   11     multiples                      -0.000051       0.0755
   12     nobles                         -0.000050       0.0868
   13     grandi                         -0.000047       0.0701
   14     vienne                         -0.000044       0.0539
   15     regrette                       -0.000042       0.0601
couche 1 (64 neurones) → influence via L1 seulement
calcul : ∂sortie/∂terme via L1 = Σ [∂sortie/∂L1 × ∂L1/∂terme]

 termes poussant vers 'FEMME' (via L1):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      supplique                      +0.002119       0.1399
   2      retrouverai                    +0.001767       0.1134
   3      multiples                      +0.001545       0.0755
   4      sacrifice                      +0.001424       0.0777
   5      offrir                         +0.001337       0.1003
   6      respecte                       +0.001257       0.0799
   7      familles                       +0.001155       0.0594
   8      hospitalité                    +0.001032       0.0939
   9      attendrons                     +0.000979       0.1519
   10     idéal                          +0.000943       0.0651
   11     baie                           +0.000921       0.0804
   12     accompagner                    +0.000857       0.0525
   13     parfaite                       +0.000725       0.0553
   14     messager                       +0.000724       0.1048
   15     accompagnera                   +0.000713       0.1419

 termes éloignant de 'FEMME' (via L1):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       -0.004081       0.3624
   2      éduqué                         -0.002330       0.1519
   3      citoyens                       -0.001986       0.1096
   4      partiras                       -0.001731       0.1591
   5      victoires                      -0.001426       0.1054
   6      remporter                      -0.001416       0.1229
   7      prisonnier                     -0.001371       0.0686
   8      connaissant                    -0.001345       0.0838
   9      apprit                         -0.001281       0.0701
   10     repéré                         -0.001273       0.0830
   11     rendit                         -0.001126       0.0633
   12     conseil                        -0.001105       0.0551
   13     servi                          -0.001089       0.0500
   14     grec                           -0.001089       0.0939
   15     esclave                        -0.001063       0.1708
 couche d'entrée (tf-idf) → gradient direct
calcul : ∂sortie/∂terme = gradient_input × valeur_tf-idf

 termes poussant vers 'FEMME' (gradient direct):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      supplique                      +0.120505       0.1399
   2      retrouverai                    +0.090449       0.1134
   3      multiples                      +0.084753       0.0755
   4      attendrons                     +0.075162       0.1519
   5      sacrifice                      +0.070883       0.0777
   6      hospitalité                    +0.066951       0.0939
   7      offrir                         +0.065473       0.1003
   8      précepteur                     +0.064320       0.2962
   9      respecte                       +0.061467       0.0799
   10     familles                       +0.060477       0.0594
   11     baie                           +0.056932       0.0804
   12     fidèle                         +0.048012       0.0579
   13     idéal                          +0.047124       0.0651
   14     messager                       +0.044037       0.1048
   15     accompagner                    +0.043869       0.0525

 termes éloignant de 'FEMME' (gradient direct):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       -0.190059       0.3624
   2      citoyens                       -0.106835       0.1096
   3      éduqué                         -0.106097       0.1519
   4      partiras                       -0.088059       0.1591
   5      connaissant                    -0.078941       0.0838
   6      remporter                      -0.077796       0.1229
   7      prisonnier                     -0.076006       0.0686
   8      victoires                      -0.070357       0.1054
   9      apprit                         -0.070138       0.0701
   10     servi                          -0.060519       0.0500
   11     grec                           -0.059904       0.0939
   12     repéré                         -0.059171       0.0830
   13     esclave                        -0.056542       0.1708
   14     conseil                        -0.055011       0.0551
   15     cingla                         -0.054155       0.1575
synthèse : chemin complet de la rétropropagation
pour chaque terme : ∂sortie/∂terme = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

exemples d'évolution de contribution (top 5 termes):
terme                     via L1          via L1→L2       final           tf-idf    
--------------------------------------------------------------------------------
carthage                  +0.000000     +0.000297     +0.000297     0.3624
précepteur                +0.000605     +0.000196     +0.000196     0.2962
cingla                    +0.000000     +0.000187     +0.000187     0.1575
messager                  +0.000724     +0.000079     +0.000079     0.1048
éduqué                    +0.000000     +0.000076     +0.000076     0.1519
flotte                    +0.000000     +0.000074     +0.000074     0.2247
constituait               +0.000328     +0.000071     +0.000071     0.0913
partiras                  +0.000000     +0.000061     +0.000061     0.1591
attentions                +0.000000     +0.000061     +0.000061     0.0981
effectivement             +0.000261     +0.000053     +0.000053     0.0765
hôtes                     +0.000000     +0.000047     +0.000047     0.0816
repéré                    +0.000000     +0.000046     +0.000046     0.0830
influents                 +0.000000     +0.000046     +0.000046     0.1575
remporter                 +0.000000     +0.000040     +0.000040     0.1229
durant                    +0.000000     +0.000039     +0.000039     0.0535
prudent                   +0.000000     +0.000038     +0.000038     0.0676
donnerais                 +0.000000     +0.000038     +0.000038     0.0927
devons                    +0.000350     +0.000037     +0.000037     0.0645
aurez                     +0.000000     +0.000036     +0.000036     0.0586
originaire                +0.000071     +0.000031     +0.000031     0.1056
logit final pour 'femme': -0.0974
# analyse pour la classe: HOMME  prédite
# logit: 0.1374
chain rule : ∂sortie/∂terme = Σ ∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme
ordre de la rétropropagation : sortie → L2 → L1 → terme
 couche de sortie → termes via tout le réseau
calcul : ∂sortie/∂terme = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

 termes poussant vers 'HOMME' (contribution finale):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      précepteur                     +0.000157       0.2962
   2      carthage                       +0.000083       0.3624
   3      attentions                     +0.000056       0.0981
   4      éduqué                         +0.000053       0.1519
   5      partiras                       +0.000045       0.1591
   6      cingla                         +0.000044       0.1575
   7      flotte                         +0.000037       0.2247
   8      remercier                      +0.000036       0.0652
   9      effectivement                  +0.000036       0.0765
   10     servile                        +0.000036       0.1365
   11     devons                         +0.000035       0.0645
   12     repéré                         +0.000034       0.0830
   13     constituait                    +0.000029       0.0913
   14     originaire                     +0.000028       0.1056
   15     rendit                         +0.000027       0.0633

 termes éloignant de 'HOMME' (contribution finale):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      accompagnera                   -0.000065       0.1419
   2      esclave                        -0.000063       0.1708
   3      logé                           -0.000062       0.2231
   4      romaine                        -0.000055       0.1123
   5      idéal                          -0.000049       0.0651
   6      manquaient                     -0.000044       0.0799
   7      grec                           -0.000041       0.0939
   8      retrouverai                    -0.000040       0.1134
   9      grandi                         -0.000037       0.0701
   10     scrupules                      -0.000037       0.0829
   11     supplique                      -0.000035       0.1399
   12     veuf                           -0.000034       0.1026
   13     hospitalité                    -0.000034       0.0939
   14     apprise                        -0.000030       0.1182
   15     nobles                         -0.000028       0.0868
couche 2 (32 neurones) → influence via L1 → L2
calcul : ∂sortie/∂terme via L2 = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

 termes poussant vers 'HOMME' (via L1 → L2):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      précepteur                     +0.000157       0.2962
   2      carthage                       +0.000083       0.3624
   3      attentions                     +0.000056       0.0981
   4      éduqué                         +0.000053       0.1519
   5      partiras                       +0.000045       0.1591
   6      cingla                         +0.000044       0.1575
   7      flotte                         +0.000037       0.2247
   8      remercier                      +0.000036       0.0652
   9      effectivement                  +0.000036       0.0765
   10     servile                        +0.000036       0.1365
   11     devons                         +0.000035       0.0645
   12     repéré                         +0.000034       0.0830
   13     constituait                    +0.000029       0.0913
   14     originaire                     +0.000028       0.1056
   15     rendit                         +0.000027       0.0633

 termes éloignant de 'HOMME' (via L1 → L2):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      accompagnera                   -0.000065       0.1419
   2      esclave                        -0.000063       0.1708
   3      logé                           -0.000062       0.2231
   4      romaine                        -0.000055       0.1123
   5      idéal                          -0.000049       0.0651
   6      manquaient                     -0.000044       0.0799
   7      grec                           -0.000041       0.0939
   8      retrouverai                    -0.000040       0.1134
   9      grandi                         -0.000037       0.0701
   10     scrupules                      -0.000037       0.0829
   11     supplique                      -0.000035       0.1399
   12     veuf                           -0.000034       0.1026
   13     hospitalité                    -0.000034       0.0939
   14     apprise                        -0.000030       0.1182
   15     nobles                         -0.000028       0.0868
couche 1 (64 neurones) → influence via L1 seulement
calcul : ∂sortie/∂terme via L1 = Σ [∂sortie/∂L1 × ∂L1/∂terme]

 termes poussant vers 'HOMME' (via L1):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       +0.002462       0.3624
   2      éduqué                         +0.001984       0.1519
   3      citoyens                       +0.001659       0.1096
   4      esclave                        +0.001293       0.1708
   5      partiras                       +0.001293       0.1591
   6      connaissant                    +0.001023       0.0838
   7      prisonnier                     +0.001018       0.0686
   8      victoires                      +0.001001       0.1054
   9      remporter                      +0.000886       0.1229
   10     apprit                         +0.000878       0.0701
   11     solennel                       +0.000863       0.0891
   12     cingla                         +0.000805       0.1575
   13     rendit                         +0.000797       0.0633
   14     donnerais                      +0.000792       0.0927
   15     servi                          +0.000782       0.0500

 termes éloignant de 'HOMME' (via L1):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      supplique                      -0.001487       0.1399
   2      sacrifice                      -0.001055       0.0777
   3      retrouverai                    -0.000994       0.1134
   4      multiples                      -0.000989       0.0755
   5      offrir                         -0.000921       0.1003
   6      hospitalité                    -0.000890       0.0939
   7      baie                           -0.000780       0.0804
   8      familles                       -0.000769       0.0594
   9      respecte                       -0.000735       0.0799
   10     accompagnera                   -0.000711       0.1419
   11     idéal                          -0.000636       0.0651
   12     précepteur                     -0.000588       0.2962
   13     vienne                         -0.000575       0.0539
   14     parfaite                       -0.000537       0.0553
   15     accompagner                    -0.000477       0.0525
 couche d'entrée (tf-idf) → gradient direct
calcul : ∂sortie/∂terme = gradient_input × valeur_tf-idf

 termes poussant vers 'HOMME' (gradient direct):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      carthage                       +0.127894       0.3624
   2      éduqué                         +0.099183       0.1519
   3      citoyens                       +0.079619       0.1096
   4      esclave                        +0.066955       0.1708
   5      remporter                      +0.057428       0.1229
   6      partiras                       +0.057352       0.1591
   7      connaissant                    +0.056440       0.0838
   8      prisonnier                     +0.055042       0.0686
   9      cingla                         +0.051404       0.1575
   10     apprit                         +0.049709       0.0701
   11     victoires                      +0.048272       0.1054
   12     solennel                       +0.043125       0.0891
   13     servi                          +0.043039       0.0500
   14     grec                           +0.042752       0.0939
   15     rendit                         +0.038957       0.0633

 termes éloignant de 'HOMME' (gradient direct):
   rang   terme                          contribution    tf-idf    
   -----------------------------------------------------------------
   1      supplique                      -0.087044       0.1399
   2      retrouverai                    -0.057276       0.1134
   3      hospitalité                    -0.054762       0.0939
   4      sacrifice                      -0.054577       0.0777
   5      multiples                      -0.053852       0.0755
   6      offrir                         -0.044640       0.1003
   7      familles                       -0.041877       0.0594
   8      accompagnera                   -0.041603       0.1419
   9      attendrons                     -0.039243       0.1519
   10     baie                           -0.038168       0.0804
   11     respecte                       -0.036258       0.0799
   12     idéal                          -0.032304       0.0651
   13     fidèle                         -0.031602       0.0579
   14     vienne                         -0.030338       0.0539
   15     précepteur                     -0.026918       0.2962
synthèse : chemin complet de la rétropropagation
pour chaque terme : ∂sortie/∂terme = Σ [∂sortie/∂L2 × ∂L2/∂L1 × ∂L1/∂terme]

exemples d'évolution de contribution (top 5 termes):
terme                     via L1          via L1→L2       final           tf-idf    
--------------------------------------------------------------------------------
précepteur                +0.000000     +0.000157     +0.000157     0.2962
carthage                  +0.002462     +0.000083     +0.000083     0.3624
attentions                +0.000463     +0.000056     +0.000056     0.0981
éduqué                    +0.001984     +0.000053     +0.000053     0.1519
partiras                  +0.001293     +0.000045     +0.000045     0.1591
cingla                    +0.000805     +0.000044     +0.000044     0.1575
flotte                    +0.000000     +0.000037     +0.000037     0.2247
remercier                 +0.000000     +0.000036     +0.000036     0.0652
effectivement             +0.000000     +0.000036     +0.000036     0.0765
servile                   +0.000572     +0.000036     +0.000036     0.1365
devons                    +0.000000     +0.000035     +0.000035     0.0645
repéré                    +0.000779     +0.000034     +0.000034     0.0830
constituait               +0.000000     +0.000029     +0.000029     0.0913
originaire                +0.000000     +0.000028     +0.000028     0.1056
rendit                    +0.000797     +0.000027     +0.000027     0.0633
accorder                  +0.000543     +0.000026     +0.000026     0.0666
connaissant               +0.001023     +0.000024     +0.000024     0.0838
accompagner               +0.000000     +0.000023     +0.000023     0.0525
aurez                     +0.000033     +0.000022     +0.000022     0.0586
donnerais                 +0.000792     +0.000022     +0.000022     0.0927
logit final pour 'homme': 0.1374
